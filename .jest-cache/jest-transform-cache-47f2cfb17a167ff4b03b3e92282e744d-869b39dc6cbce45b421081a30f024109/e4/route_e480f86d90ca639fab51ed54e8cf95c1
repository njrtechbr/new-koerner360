36ddadb11b74d7606b9d73f67b5a5437
"use strict";

/* istanbul ignore next */
function cov_2pnuux640m() {
  var path = "C:\\Users\\Nereu Jr\\Documents\\Dev\\new\\src\\app\\api\\atendentes\\[id]\\desativar\\route.ts";
  var hash = "99e6b369c6c24f8cc4ac72216b48702194bfcc29";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\Nereu Jr\\Documents\\Dev\\new\\src\\app\\api\\atendentes\\[id]\\desativar\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 20
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 18
        },
        end: {
          line: 12,
          column: 38
        }
      },
      "5": {
        start: {
          line: 13,
          column: 14
        },
        end: {
          line: 13,
          column: 48
        }
      },
      "6": {
        start: {
          line: 14,
          column: 16
        },
        end: {
          line: 14,
          column: 52
        }
      },
      "7": {
        start: {
          line: 15,
          column: 20
        },
        end: {
          line: 15,
          column: 72
        }
      },
      "8": {
        start: {
          line: 16,
          column: 13
        },
        end: {
          line: 16,
          column: 27
        }
      },
      "9": {
        start: {
          line: 18,
          column: 4
        },
        end: {
          line: 164,
          column: 5
        }
      },
      "10": {
        start: {
          line: 20,
          column: 24
        },
        end: {
          line: 20,
          column: 80
        }
      },
      "11": {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 27,
          column: 9
        }
      },
      "12": {
        start: {
          line: 22,
          column: 12
        },
        end: {
          line: 26,
          column: 15
        }
      },
      "13": {
        start: {
          line: 29,
          column: 8
        },
        end: {
          line: 35,
          column: 9
        }
      },
      "14": {
        start: {
          line: 30,
          column: 12
        },
        end: {
          line: 34,
          column: 15
        }
      },
      "15": {
        start: {
          line: 37,
          column: 28
        },
        end: {
          line: 37,
          column: 74
        }
      },
      "16": {
        start: {
          line: 39,
          column: 26
        },
        end: {
          line: 53,
          column: 10
        }
      },
      "17": {
        start: {
          line: 54,
          column: 8
        },
        end: {
          line: 60,
          column: 9
        }
      },
      "18": {
        start: {
          line: 55,
          column: 12
        },
        end: {
          line: 59,
          column: 15
        }
      },
      "19": {
        start: {
          line: 62,
          column: 8
        },
        end: {
          line: 68,
          column: 9
        }
      },
      "20": {
        start: {
          line: 63,
          column: 12
        },
        end: {
          line: 67,
          column: 15
        }
      },
      "21": {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 76,
          column: 9
        }
      },
      "22": {
        start: {
          line: 71,
          column: 12
        },
        end: {
          line: 75,
          column: 15
        }
      },
      "23": {
        start: {
          line: 78,
          column: 32
        },
        end: {
          line: 78,
          column: 52
        }
      },
      "24": {
        start: {
          line: 80,
          column: 60
        },
        end: {
          line: 80,
          column: 119
        }
      },
      "25": {
        start: {
          line: 82,
          column: 32
        },
        end: {
          line: 85,
          column: 9
        }
      },
      "26": {
        start: {
          line: 87,
          column: 26
        },
        end: {
          line: 127,
          column: 10
        }
      },
      "27": {
        start: {
          line: 89,
          column: 38
        },
        end: {
          line: 96,
          column: 14
        }
      },
      "28": {
        start: {
          line: 98,
          column: 40
        },
        end: {
          line: 105,
          column: 14
        }
      },
      "29": {
        start: {
          line: 107,
          column: 12
        },
        end: {
          line: 122,
          column: 15
        }
      },
      "30": {
        start: {
          line: 123,
          column: 12
        },
        end: {
          line: 126,
          column: 14
        }
      },
      "31": {
        start: {
          line: 128,
          column: 8
        },
        end: {
          line: 148,
          column: 11
        }
      },
      "32": {
        start: {
          line: 150,
          column: 8
        },
        end: {
          line: 150,
          column: 61
        }
      },
      "33": {
        start: {
          line: 151,
          column: 8
        },
        end: {
          line: 158,
          column: 9
        }
      },
      "34": {
        start: {
          line: 152,
          column: 12
        },
        end: {
          line: 157,
          column: 15
        }
      },
      "35": {
        start: {
          line: 159,
          column: 8
        },
        end: {
          line: 163,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "POST",
        decl: {
          start: {
            line: 17,
            column: 15
          },
          end: {
            line: 17,
            column: 19
          }
        },
        loc: {
          start: {
            line: 17,
            column: 41
          },
          end: {
            line: 165,
            column: 1
          }
        },
        line: 17
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 87,
            column: 60
          },
          end: {
            line: 87,
            column: 61
          }
        },
        loc: {
          start: {
            line: 87,
            column: 72
          },
          end: {
            line: 127,
            column: 9
          }
        },
        line: 87
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 21,
            column: 8
          },
          end: {
            line: 27,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 21,
            column: 8
          },
          end: {
            line: 27,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 21
      },
      "1": {
        loc: {
          start: {
            line: 29,
            column: 8
          },
          end: {
            line: 35,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 29,
            column: 8
          },
          end: {
            line: 35,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 29
      },
      "2": {
        loc: {
          start: {
            line: 54,
            column: 8
          },
          end: {
            line: 60,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 54,
            column: 8
          },
          end: {
            line: 60,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 54
      },
      "3": {
        loc: {
          start: {
            line: 62,
            column: 8
          },
          end: {
            line: 68,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 62,
            column: 8
          },
          end: {
            line: 68,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 62
      },
      "4": {
        loc: {
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 62,
            column: 70
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 62,
            column: 42
          }
        }, {
          start: {
            line: 62,
            column: 46
          },
          end: {
            line: 62,
            column: 70
          }
        }],
        line: 62
      },
      "5": {
        loc: {
          start: {
            line: 70,
            column: 8
          },
          end: {
            line: 76,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 70,
            column: 8
          },
          end: {
            line: 76,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 70
      },
      "6": {
        loc: {
          start: {
            line: 146,
            column: 32
          },
          end: {
            line: 146,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 146,
            column: 32
          },
          end: {
            line: 146,
            column: 46
          }
        }, {
          start: {
            line: 146,
            column: 50
          },
          end: {
            line: 146,
            column: 54
          }
        }],
        line: 146
      },
      "7": {
        loc: {
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 158,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 158,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 151
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Users\\Nereu Jr\\Documents\\Dev\\new\\src\\app\\api\\atendentes\\[id]\\desativar\\route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server';\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\nimport { prisma } from '@/lib/prisma';\nimport { z } from 'zod';\nimport {\n  idAtendenteSchema,\n  desativarAtendenteSchema,\n  MENSAGENS_ERRO_ATENDENTES,\n} from '@/lib/validations/atendentes';\nimport { ZodError } from 'zod';\n\ninterface RouteParams {\n  params: {\n    id: string;\n  };\n}\n\n/**\n * POST /api/atendentes/[id]/desativar\n * Desativa um atendente ativo\n */\nexport async function POST(request: NextRequest, { params }: RouteParams) {\n  try {\n    // Verificar autentica\xE7\xE3o\n    const session = await getServerSession(authOptions);\n    if (!session?.user) {\n      return NextResponse.json({ erro: 'N\xE3o autorizado' }, { status: 401 });\n    }\n\n    // Verificar permiss\xF5es (apenas ADMIN pode desativar atendentes)\n    if (session.user.userType !== 'ADMIN') {\n      return NextResponse.json(\n        { erro: MENSAGENS_ERRO_ATENDENTES.SEM_PERMISSAO },\n        { status: 403 }\n      );\n    }\n\n    // Validar ID\n    const atendenteId = idAtendenteSchema.parse(params.id);\n\n    // Buscar atendente com dados do usu\xE1rio\n    const atendente = await prisma.atendente.findUnique({\n      where: { id: atendenteId },\n      include: {\n        usuario: {\n          select: {\n            id: true,\n            nome: true,\n            email: true,\n            ativo: true,\n          },\n        },\n      },\n    });\n\n    if (!atendente) {\n      return NextResponse.json(\n        { erro: MENSAGENS_ERRO_ATENDENTES.ATENDENTE_NAO_ENCONTRADO },\n        { status: 404 }\n      );\n    }\n\n    // Verificar se o atendente j\xE1 est\xE1 inativo\n    if (atendente.status === 'INATIVO' || !atendente.usuario.ativo) {\n      return NextResponse.json(\n        { erro: 'Atendente j\xE1 est\xE1 inativo' },\n        { status: 400 }\n      );\n    }\n\n    // Verificar se \xE9 o pr\xF3prio usu\xE1rio tentando se desativar\n    if (atendente.usuarioId === session.user.id) {\n      return NextResponse.json(\n        { erro: 'Voc\xEA n\xE3o pode desativar sua pr\xF3pria conta' },\n        { status: 400 }\n      );\n    }\n\n    // Extrair dados do corpo da requisi\xE7\xE3o\n    const dadosRequisicao = await request.json();\n\n    // Validar dados\n    const { motivo, tipoDesativacao, dataReativacao } =\n      desativarAtendenteSchema.parse(dadosRequisicao);\n\n    // Salvar dados anteriores para o hist\xF3rico\n    const dadosAnteriores = {\n      statusAtendente: atendente.status,\n      usuarioAtivo: atendente.usuario.ativo,\n    };\n\n    // Usar transa\xE7\xE3o para garantir consist\xEAncia\n    const resultado = await prisma.$transaction(async tx => {\n      // Desativar usu\xE1rio\n      const usuarioAtualizado = await tx.usuario.update({\n        where: { id: atendente.usuarioId },\n        data: { ativo: false },\n      });\n\n      // Atualizar status do atendente para INATIVO\n      const atendenteAtualizado = await tx.atendente.update({\n        where: { id: atendenteId },\n        data: { status: 'INATIVO' },\n      });\n\n      // Registrar no hist\xF3rico de altera\xE7\xF5es\n      await tx.historicoAlteracaoAtendente.create({\n        data: {\n          atendenteId,\n          tipo: 'DESATIVACAO',\n          descricao: `Atendente desativado (${tipoDesativacao.toLowerCase()}) - ${motivo}`,\n          valorAnterior: JSON.stringify(dadosAnteriores),\n          valorNovo: JSON.stringify({\n            statusAtendente: 'INATIVO',\n            usuarioAtivo: false,\n            motivo,\n            tipoDesativacao,\n            dataReativacao,\n          }),\n          criadoPorId: session.user.id,\n        },\n      });\n\n      return {\n        atendente: atendenteAtualizado,\n        usuario: usuarioAtualizado,\n      };\n    });\n\n    return NextResponse.json({\n      mensagem: 'Atendente desativado com sucesso',\n      atendente: {\n        id: resultado.atendente.id,\n        status: resultado.atendente.status,\n        usuario: {\n          id: resultado.usuario.id,\n          nome: resultado.usuario.nome,\n          email: resultado.usuario.email,\n          ativo: resultado.usuario.ativo,\n        },\n        desativadoEm: new Date().toISOString(),\n        desativadoPor: {\n          id: session.user.id,\n          nome: session.user.name,\n        },\n        motivo,\n        tipoDesativacao,\n        dataReativacao: dataReativacao || null,\n      },\n    });\n  } catch (error) {\n    console.error('Erro ao desativar atendente:', error);\n\n    if (error instanceof ZodError) {\n      return NextResponse.json(\n        {\n          erro: MENSAGENS_ERRO_ATENDENTES.DADOS_INVALIDOS,\n          detalhes: error.errors,\n        },\n        { status: 400 }\n      );\n    }\n\n    return NextResponse.json(\n      { erro: MENSAGENS_ERRO_ATENDENTES.ERRO_INTERNO },\n      { status: 500 }\n    );\n  }\n}\n"],
      names: ["POST", "request", "params", "session", "getServerSession", "authOptions", "user", "NextResponse", "json", "erro", "status", "userType", "MENSAGENS_ERRO_ATENDENTES", "SEM_PERMISSAO", "atendenteId", "idAtendenteSchema", "parse", "id", "atendente", "prisma", "findUnique", "where", "include", "usuario", "select", "nome", "email", "ativo", "ATENDENTE_NAO_ENCONTRADO", "usuarioId", "dadosRequisicao", "motivo", "tipoDesativacao", "dataReativacao", "desativarAtendenteSchema", "dadosAnteriores", "statusAtendente", "usuarioAtivo", "resultado", "$transaction", "tx", "usuarioAtualizado", "update", "data", "atendenteAtualizado", "historicoAlteracaoAtendente", "create", "tipo", "descricao", "toLowerCase", "valorAnterior", "JSON", "stringify", "valorNovo", "criadoPorId", "mensagem", "desativadoEm", "Date", "toISOString", "desativadoPor", "name", "error", "console", "ZodError", "DADOS_INVALIDOS", "detalhes", "errors", "ERRO_INTERNO"],
      mappings: ";;;;+BAsBsBA;;;eAAAA;;;wBAtBoB;0BACT;sBACL;wBACL;4BAMhB;qBACkB;AAYlB,eAAeA,KAAKC,OAAoB,EAAE,EAAEC,MAAM,EAAe;IACtE,IAAI;QACF,yBAAyB;QACzB,MAAMC,UAAU,MAAMC,IAAAA,0BAAgB,EAACC,iBAAW;QAClD,IAAI,CAACF,SAASG,MAAM;YAClB,OAAOC,oBAAY,CAACC,IAAI,CAAC;gBAAEC,MAAM;YAAiB,GAAG;gBAAEC,QAAQ;YAAI;QACrE;QAEA,gEAAgE;QAChE,IAAIP,QAAQG,IAAI,CAACK,QAAQ,KAAK,SAAS;YACrC,OAAOJ,oBAAY,CAACC,IAAI,CACtB;gBAAEC,MAAMG,qCAAyB,CAACC,aAAa;YAAC,GAChD;gBAAEH,QAAQ;YAAI;QAElB;QAEA,aAAa;QACb,MAAMI,cAAcC,6BAAiB,CAACC,KAAK,CAACd,OAAOe,EAAE;QAErD,wCAAwC;QACxC,MAAMC,YAAY,MAAMC,cAAM,CAACD,SAAS,CAACE,UAAU,CAAC;YAClDC,OAAO;gBAAEJ,IAAIH;YAAY;YACzBQ,SAAS;gBACPC,SAAS;oBACPC,QAAQ;wBACNP,IAAI;wBACJQ,MAAM;wBACNC,OAAO;wBACPC,OAAO;oBACT;gBACF;YACF;QACF;QAEA,IAAI,CAACT,WAAW;YACd,OAAOX,oBAAY,CAACC,IAAI,CACtB;gBAAEC,MAAMG,qCAAyB,CAACgB,wBAAwB;YAAC,GAC3D;gBAAElB,QAAQ;YAAI;QAElB;QAEA,2CAA2C;QAC3C,IAAIQ,UAAUR,MAAM,KAAK,aAAa,CAACQ,UAAUK,OAAO,CAACI,KAAK,EAAE;YAC9D,OAAOpB,oBAAY,CAACC,IAAI,CACtB;gBAAEC,MAAM;YAA4B,GACpC;gBAAEC,QAAQ;YAAI;QAElB;QAEA,yDAAyD;QACzD,IAAIQ,UAAUW,SAAS,KAAK1B,QAAQG,IAAI,CAACW,EAAE,EAAE;YAC3C,OAAOV,oBAAY,CAACC,IAAI,CACtB;gBAAEC,MAAM;YAA4C,GACpD;gBAAEC,QAAQ;YAAI;QAElB;QAEA,uCAAuC;QACvC,MAAMoB,kBAAkB,MAAM7B,QAAQO,IAAI;QAE1C,gBAAgB;QAChB,MAAM,EAAEuB,MAAM,EAAEC,eAAe,EAAEC,cAAc,EAAE,GAC/CC,oCAAwB,CAAClB,KAAK,CAACc;QAEjC,2CAA2C;QAC3C,MAAMK,kBAAkB;YACtBC,iBAAiBlB,UAAUR,MAAM;YACjC2B,cAAcnB,UAAUK,OAAO,CAACI,KAAK;QACvC;QAEA,4CAA4C;QAC5C,MAAMW,YAAY,MAAMnB,cAAM,CAACoB,YAAY,CAAC,OAAMC;YAChD,oBAAoB;YACpB,MAAMC,oBAAoB,MAAMD,GAAGjB,OAAO,CAACmB,MAAM,CAAC;gBAChDrB,OAAO;oBAAEJ,IAAIC,UAAUW,SAAS;gBAAC;gBACjCc,MAAM;oBAAEhB,OAAO;gBAAM;YACvB;YAEA,6CAA6C;YAC7C,MAAMiB,sBAAsB,MAAMJ,GAAGtB,SAAS,CAACwB,MAAM,CAAC;gBACpDrB,OAAO;oBAAEJ,IAAIH;gBAAY;gBACzB6B,MAAM;oBAAEjC,QAAQ;gBAAU;YAC5B;YAEA,uCAAuC;YACvC,MAAM8B,GAAGK,2BAA2B,CAACC,MAAM,CAAC;gBAC1CH,MAAM;oBACJ7B;oBACAiC,MAAM;oBACNC,WAAW,CAAC,sBAAsB,EAAEhB,gBAAgBiB,WAAW,GAAG,IAAI,EAAElB,QAAQ;oBAChFmB,eAAeC,KAAKC,SAAS,CAACjB;oBAC9BkB,WAAWF,KAAKC,SAAS,CAAC;wBACxBhB,iBAAiB;wBACjBC,cAAc;wBACdN;wBACAC;wBACAC;oBACF;oBACAqB,aAAanD,QAAQG,IAAI,CAACW,EAAE;gBAC9B;YACF;YAEA,OAAO;gBACLC,WAAW0B;gBACXrB,SAASkB;YACX;QACF;QAEA,OAAOlC,oBAAY,CAACC,IAAI,CAAC;YACvB+C,UAAU;YACVrC,WAAW;gBACTD,IAAIqB,UAAUpB,SAAS,CAACD,EAAE;gBAC1BP,QAAQ4B,UAAUpB,SAAS,CAACR,MAAM;gBAClCa,SAAS;oBACPN,IAAIqB,UAAUf,OAAO,CAACN,EAAE;oBACxBQ,MAAMa,UAAUf,OAAO,CAACE,IAAI;oBAC5BC,OAAOY,UAAUf,OAAO,CAACG,KAAK;oBAC9BC,OAAOW,UAAUf,OAAO,CAACI,KAAK;gBAChC;gBACA6B,cAAc,IAAIC,OAAOC,WAAW;gBACpCC,eAAe;oBACb1C,IAAId,QAAQG,IAAI,CAACW,EAAE;oBACnBQ,MAAMtB,QAAQG,IAAI,CAACsD,IAAI;gBACzB;gBACA7B;gBACAC;gBACAC,gBAAgBA,kBAAkB;YACpC;QACF;IACF,EAAE,OAAO4B,OAAO;QACdC,QAAQD,KAAK,CAAC,gCAAgCA;QAE9C,IAAIA,iBAAiBE,aAAQ,EAAE;YAC7B,OAAOxD,oBAAY,CAACC,IAAI,CACtB;gBACEC,MAAMG,qCAAyB,CAACoD,eAAe;gBAC/CC,UAAUJ,MAAMK,MAAM;YACxB,GACA;gBAAExD,QAAQ;YAAI;QAElB;QAEA,OAAOH,oBAAY,CAACC,IAAI,CACtB;YAAEC,MAAMG,qCAAyB,CAACuD,YAAY;QAAC,GAC/C;YAAEzD,QAAQ;QAAI;IAElB;AACF"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "99e6b369c6c24f8cc4ac72216b48702194bfcc29"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2pnuux640m = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2pnuux640m();
cov_2pnuux640m().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_2pnuux640m().s[1]++;
Object.defineProperty(exports, "POST", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_2pnuux640m().f[0]++;
    cov_2pnuux640m().s[2]++;
    return POST;
  }
});
const _server =
/* istanbul ignore next */
(cov_2pnuux640m().s[3]++, require("next/server"));
const _nextauth =
/* istanbul ignore next */
(cov_2pnuux640m().s[4]++, require("next-auth"));
const _auth =
/* istanbul ignore next */
(cov_2pnuux640m().s[5]++, require("../../../../../lib/auth"));
const _prisma =
/* istanbul ignore next */
(cov_2pnuux640m().s[6]++, require("../../../../../lib/prisma"));
const _atendentes =
/* istanbul ignore next */
(cov_2pnuux640m().s[7]++, require("../../../../../lib/validations/atendentes"));
const _zod =
/* istanbul ignore next */
(cov_2pnuux640m().s[8]++, require("zod"));
async function POST(request, {
  params
}) {
  /* istanbul ignore next */
  cov_2pnuux640m().f[1]++;
  cov_2pnuux640m().s[9]++;
  try {
    // Verificar autenticação
    const session =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[10]++, await (0, _nextauth.getServerSession)(_auth.authOptions));
    /* istanbul ignore next */
    cov_2pnuux640m().s[11]++;
    if (!session?.user) {
      /* istanbul ignore next */
      cov_2pnuux640m().b[0][0]++;
      cov_2pnuux640m().s[12]++;
      return _server.NextResponse.json({
        erro: 'Não autorizado'
      }, {
        status: 401
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[0][1]++;
    }
    // Verificar permissões (apenas ADMIN pode desativar atendentes)
    cov_2pnuux640m().s[13]++;
    if (session.user.userType !== 'ADMIN') {
      /* istanbul ignore next */
      cov_2pnuux640m().b[1][0]++;
      cov_2pnuux640m().s[14]++;
      return _server.NextResponse.json({
        erro: _atendentes.MENSAGENS_ERRO_ATENDENTES.SEM_PERMISSAO
      }, {
        status: 403
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[1][1]++;
    }
    // Validar ID
    const atendenteId =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[15]++, _atendentes.idAtendenteSchema.parse(params.id));
    // Buscar atendente com dados do usuário
    const atendente =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[16]++, await _prisma.prisma.atendente.findUnique({
      where: {
        id: atendenteId
      },
      include: {
        usuario: {
          select: {
            id: true,
            nome: true,
            email: true,
            ativo: true
          }
        }
      }
    }));
    /* istanbul ignore next */
    cov_2pnuux640m().s[17]++;
    if (!atendente) {
      /* istanbul ignore next */
      cov_2pnuux640m().b[2][0]++;
      cov_2pnuux640m().s[18]++;
      return _server.NextResponse.json({
        erro: _atendentes.MENSAGENS_ERRO_ATENDENTES.ATENDENTE_NAO_ENCONTRADO
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[2][1]++;
    }
    // Verificar se o atendente já está inativo
    cov_2pnuux640m().s[19]++;
    if (
    /* istanbul ignore next */
    (cov_2pnuux640m().b[4][0]++, atendente.status === 'INATIVO') ||
    /* istanbul ignore next */
    (cov_2pnuux640m().b[4][1]++, !atendente.usuario.ativo)) {
      /* istanbul ignore next */
      cov_2pnuux640m().b[3][0]++;
      cov_2pnuux640m().s[20]++;
      return _server.NextResponse.json({
        erro: 'Atendente já está inativo'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[3][1]++;
    }
    // Verificar se é o próprio usuário tentando se desativar
    cov_2pnuux640m().s[21]++;
    if (atendente.usuarioId === session.user.id) {
      /* istanbul ignore next */
      cov_2pnuux640m().b[5][0]++;
      cov_2pnuux640m().s[22]++;
      return _server.NextResponse.json({
        erro: 'Você não pode desativar sua própria conta'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[5][1]++;
    }
    // Extrair dados do corpo da requisição
    const dadosRequisicao =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[23]++, await request.json());
    // Validar dados
    const {
      motivo,
      tipoDesativacao,
      dataReativacao
    } =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[24]++, _atendentes.desativarAtendenteSchema.parse(dadosRequisicao));
    // Salvar dados anteriores para o histórico
    const dadosAnteriores =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[25]++, {
      statusAtendente: atendente.status,
      usuarioAtivo: atendente.usuario.ativo
    });
    // Usar transação para garantir consistência
    const resultado =
    /* istanbul ignore next */
    (cov_2pnuux640m().s[26]++, await _prisma.prisma.$transaction(async tx => {
      /* istanbul ignore next */
      cov_2pnuux640m().f[2]++;
      // Desativar usuário
      const usuarioAtualizado =
      /* istanbul ignore next */
      (cov_2pnuux640m().s[27]++, await tx.usuario.update({
        where: {
          id: atendente.usuarioId
        },
        data: {
          ativo: false
        }
      }));
      // Atualizar status do atendente para INATIVO
      const atendenteAtualizado =
      /* istanbul ignore next */
      (cov_2pnuux640m().s[28]++, await tx.atendente.update({
        where: {
          id: atendenteId
        },
        data: {
          status: 'INATIVO'
        }
      }));
      // Registrar no histórico de alterações
      /* istanbul ignore next */
      cov_2pnuux640m().s[29]++;
      await tx.historicoAlteracaoAtendente.create({
        data: {
          atendenteId,
          tipo: 'DESATIVACAO',
          descricao: `Atendente desativado (${tipoDesativacao.toLowerCase()}) - ${motivo}`,
          valorAnterior: JSON.stringify(dadosAnteriores),
          valorNovo: JSON.stringify({
            statusAtendente: 'INATIVO',
            usuarioAtivo: false,
            motivo,
            tipoDesativacao,
            dataReativacao
          }),
          criadoPorId: session.user.id
        }
      });
      /* istanbul ignore next */
      cov_2pnuux640m().s[30]++;
      return {
        atendente: atendenteAtualizado,
        usuario: usuarioAtualizado
      };
    }));
    /* istanbul ignore next */
    cov_2pnuux640m().s[31]++;
    return _server.NextResponse.json({
      mensagem: 'Atendente desativado com sucesso',
      atendente: {
        id: resultado.atendente.id,
        status: resultado.atendente.status,
        usuario: {
          id: resultado.usuario.id,
          nome: resultado.usuario.nome,
          email: resultado.usuario.email,
          ativo: resultado.usuario.ativo
        },
        desativadoEm: new Date().toISOString(),
        desativadoPor: {
          id: session.user.id,
          nome: session.user.name
        },
        motivo,
        tipoDesativacao,
        dataReativacao:
        /* istanbul ignore next */
        (cov_2pnuux640m().b[6][0]++, dataReativacao) ||
        /* istanbul ignore next */
        (cov_2pnuux640m().b[6][1]++, null)
      }
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_2pnuux640m().s[32]++;
    console.error('Erro ao desativar atendente:', error);
    /* istanbul ignore next */
    cov_2pnuux640m().s[33]++;
    if (error instanceof _zod.ZodError) {
      /* istanbul ignore next */
      cov_2pnuux640m().b[7][0]++;
      cov_2pnuux640m().s[34]++;
      return _server.NextResponse.json({
        erro: _atendentes.MENSAGENS_ERRO_ATENDENTES.DADOS_INVALIDOS,
        detalhes: error.errors
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2pnuux640m().b[7][1]++;
    }
    cov_2pnuux640m().s[35]++;
    return _server.NextResponse.json({
      erro: _atendentes.MENSAGENS_ERRO_ATENDENTES.ERRO_INTERNO
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQT1NUIiwicmVxdWVzdCIsInBhcmFtcyIsImNvdl8ycG51dXg2NDBtIiwiZiIsInMiLCJzZXNzaW9uIiwiX25leHRhdXRoIiwiZ2V0U2VydmVyU2Vzc2lvbiIsIl9hdXRoIiwiYXV0aE9wdGlvbnMiLCJ1c2VyIiwiYiIsIl9zZXJ2ZXIiLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwiZXJybyIsInN0YXR1cyIsInVzZXJUeXBlIiwiX2F0ZW5kZW50ZXMiLCJNRU5TQUdFTlNfRVJST19BVEVOREVOVEVTIiwiU0VNX1BFUk1JU1NBTyIsImF0ZW5kZW50ZUlkIiwiaWRBdGVuZGVudGVTY2hlbWEiLCJwYXJzZSIsImlkIiwiYXRlbmRlbnRlIiwiX3ByaXNtYSIsInByaXNtYSIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJ1c3VhcmlvIiwic2VsZWN0Iiwibm9tZSIsImVtYWlsIiwiYXRpdm8iLCJBVEVOREVOVEVfTkFPX0VOQ09OVFJBRE8iLCJ1c3VhcmlvSWQiLCJkYWRvc1JlcXVpc2ljYW8iLCJtb3Rpdm8iLCJ0aXBvRGVzYXRpdmFjYW8iLCJkYXRhUmVhdGl2YWNhbyIsImRlc2F0aXZhckF0ZW5kZW50ZVNjaGVtYSIsImRhZG9zQW50ZXJpb3JlcyIsInN0YXR1c0F0ZW5kZW50ZSIsInVzdWFyaW9BdGl2byIsInJlc3VsdGFkbyIsIiR0cmFuc2FjdGlvbiIsInR4IiwidXN1YXJpb0F0dWFsaXphZG8iLCJ1cGRhdGUiLCJkYXRhIiwiYXRlbmRlbnRlQXR1YWxpemFkbyIsImhpc3Rvcmljb0FsdGVyYWNhb0F0ZW5kZW50ZSIsImNyZWF0ZSIsInRpcG8iLCJkZXNjcmljYW8iLCJ0b0xvd2VyQ2FzZSIsInZhbG9yQW50ZXJpb3IiLCJKU09OIiwic3RyaW5naWZ5IiwidmFsb3JOb3ZvIiwiY3JpYWRvUG9ySWQiLCJtZW5zYWdlbSIsImRlc2F0aXZhZG9FbSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRlc2F0aXZhZG9Qb3IiLCJuYW1lIiwiZXJyb3IiLCJjb25zb2xlIiwiX3pvZCIsIlpvZEVycm9yIiwiREFET1NfSU5WQUxJRE9TIiwiZGV0YWxoZXMiLCJlcnJvcnMiLCJFUlJPX0lOVEVSTk8iXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXE5lcmV1IEpyXFxEb2N1bWVudHNcXERldlxcbmV3XFxzcmNcXGFwcFxcYXBpXFxhdGVuZGVudGVzXFxbaWRdXFxkZXNhdGl2YXJcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQge1xuICBpZEF0ZW5kZW50ZVNjaGVtYSxcbiAgZGVzYXRpdmFyQXRlbmRlbnRlU2NoZW1hLFxuICBNRU5TQUdFTlNfRVJST19BVEVOREVOVEVTLFxufSBmcm9tICdAL2xpYi92YWxpZGF0aW9ucy9hdGVuZGVudGVzJztcbmltcG9ydCB7IFpvZEVycm9yIH0gZnJvbSAnem9kJztcblxuaW50ZXJmYWNlIFJvdXRlUGFyYW1zIHtcbiAgcGFyYW1zOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgfTtcbn1cblxuLyoqXG4gKiBQT1NUIC9hcGkvYXRlbmRlbnRlcy9baWRdL2Rlc2F0aXZhclxuICogRGVzYXRpdmEgdW0gYXRlbmRlbnRlIGF0aXZvXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCB7IHBhcmFtcyB9OiBSb3V0ZVBhcmFtcykge1xuICB0cnkge1xuICAgIC8vIFZlcmlmaWNhciBhdXRlbnRpY2HDp8Ojb1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKTtcbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm86ICdOw6NvIGF1dG9yaXphZG8nIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIHBlcm1pc3PDtWVzIChhcGVuYXMgQURNSU4gcG9kZSBkZXNhdGl2YXIgYXRlbmRlbnRlcylcbiAgICBpZiAoc2Vzc2lvbi51c2VyLnVzZXJUeXBlICE9PSAnQURNSU4nKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJybzogTUVOU0FHRU5TX0VSUk9fQVRFTkRFTlRFUy5TRU1fUEVSTUlTU0FPIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGFyIElEXG4gICAgY29uc3QgYXRlbmRlbnRlSWQgPSBpZEF0ZW5kZW50ZVNjaGVtYS5wYXJzZShwYXJhbXMuaWQpO1xuXG4gICAgLy8gQnVzY2FyIGF0ZW5kZW50ZSBjb20gZGFkb3MgZG8gdXN1w6FyaW9cbiAgICBjb25zdCBhdGVuZGVudGUgPSBhd2FpdCBwcmlzbWEuYXRlbmRlbnRlLmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IGF0ZW5kZW50ZUlkIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIHVzdWFyaW86IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgbm9tZTogdHJ1ZSxcbiAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgICAgYXRpdm86IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIWF0ZW5kZW50ZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm86IE1FTlNBR0VOU19FUlJPX0FURU5ERU5URVMuQVRFTkRFTlRFX05BT19FTkNPTlRSQURPIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZmljYXIgc2UgbyBhdGVuZGVudGUgasOhIGVzdMOhIGluYXRpdm9cbiAgICBpZiAoYXRlbmRlbnRlLnN0YXR1cyA9PT0gJ0lOQVRJVk8nIHx8ICFhdGVuZGVudGUudXN1YXJpby5hdGl2bykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm86ICdBdGVuZGVudGUgasOhIGVzdMOhIGluYXRpdm8nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZmljYXIgc2Ugw6kgbyBwcsOzcHJpbyB1c3XDoXJpbyB0ZW50YW5kbyBzZSBkZXNhdGl2YXJcbiAgICBpZiAoYXRlbmRlbnRlLnVzdWFyaW9JZCA9PT0gc2Vzc2lvbi51c2VyLmlkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJybzogJ1ZvY8OqIG7Do28gcG9kZSBkZXNhdGl2YXIgc3VhIHByw7NwcmlhIGNvbnRhJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFpciBkYWRvcyBkbyBjb3JwbyBkYSByZXF1aXNpw6fDo29cbiAgICBjb25zdCBkYWRvc1JlcXVpc2ljYW8gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIC8vIFZhbGlkYXIgZGFkb3NcbiAgICBjb25zdCB7IG1vdGl2bywgdGlwb0Rlc2F0aXZhY2FvLCBkYXRhUmVhdGl2YWNhbyB9ID1cbiAgICAgIGRlc2F0aXZhckF0ZW5kZW50ZVNjaGVtYS5wYXJzZShkYWRvc1JlcXVpc2ljYW8pO1xuXG4gICAgLy8gU2FsdmFyIGRhZG9zIGFudGVyaW9yZXMgcGFyYSBvIGhpc3TDs3JpY29cbiAgICBjb25zdCBkYWRvc0FudGVyaW9yZXMgPSB7XG4gICAgICBzdGF0dXNBdGVuZGVudGU6IGF0ZW5kZW50ZS5zdGF0dXMsXG4gICAgICB1c3VhcmlvQXRpdm86IGF0ZW5kZW50ZS51c3VhcmlvLmF0aXZvLFxuICAgIH07XG5cbiAgICAvLyBVc2FyIHRyYW5zYcOnw6NvIHBhcmEgZ2FyYW50aXIgY29uc2lzdMOqbmNpYVxuICAgIGNvbnN0IHJlc3VsdGFkbyA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgdHggPT4ge1xuICAgICAgLy8gRGVzYXRpdmFyIHVzdcOhcmlvXG4gICAgICBjb25zdCB1c3VhcmlvQXR1YWxpemFkbyA9IGF3YWl0IHR4LnVzdWFyaW8udXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGF0ZW5kZW50ZS51c3VhcmlvSWQgfSxcbiAgICAgICAgZGF0YTogeyBhdGl2bzogZmFsc2UgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBdHVhbGl6YXIgc3RhdHVzIGRvIGF0ZW5kZW50ZSBwYXJhIElOQVRJVk9cbiAgICAgIGNvbnN0IGF0ZW5kZW50ZUF0dWFsaXphZG8gPSBhd2FpdCB0eC5hdGVuZGVudGUudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGF0ZW5kZW50ZUlkIH0sXG4gICAgICAgIGRhdGE6IHsgc3RhdHVzOiAnSU5BVElWTycgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBSZWdpc3RyYXIgbm8gaGlzdMOzcmljbyBkZSBhbHRlcmHDp8O1ZXNcbiAgICAgIGF3YWl0IHR4Lmhpc3Rvcmljb0FsdGVyYWNhb0F0ZW5kZW50ZS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgYXRlbmRlbnRlSWQsXG4gICAgICAgICAgdGlwbzogJ0RFU0FUSVZBQ0FPJyxcbiAgICAgICAgICBkZXNjcmljYW86IGBBdGVuZGVudGUgZGVzYXRpdmFkbyAoJHt0aXBvRGVzYXRpdmFjYW8udG9Mb3dlckNhc2UoKX0pIC0gJHttb3Rpdm99YCxcbiAgICAgICAgICB2YWxvckFudGVyaW9yOiBKU09OLnN0cmluZ2lmeShkYWRvc0FudGVyaW9yZXMpLFxuICAgICAgICAgIHZhbG9yTm92bzogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc3RhdHVzQXRlbmRlbnRlOiAnSU5BVElWTycsXG4gICAgICAgICAgICB1c3VhcmlvQXRpdm86IGZhbHNlLFxuICAgICAgICAgICAgbW90aXZvLFxuICAgICAgICAgICAgdGlwb0Rlc2F0aXZhY2FvLFxuICAgICAgICAgICAgZGF0YVJlYXRpdmFjYW8sXG4gICAgICAgICAgfSksXG4gICAgICAgICAgY3JpYWRvUG9ySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhdGVuZGVudGU6IGF0ZW5kZW50ZUF0dWFsaXphZG8sXG4gICAgICAgIHVzdWFyaW86IHVzdWFyaW9BdHVhbGl6YWRvLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBtZW5zYWdlbTogJ0F0ZW5kZW50ZSBkZXNhdGl2YWRvIGNvbSBzdWNlc3NvJyxcbiAgICAgIGF0ZW5kZW50ZToge1xuICAgICAgICBpZDogcmVzdWx0YWRvLmF0ZW5kZW50ZS5pZCxcbiAgICAgICAgc3RhdHVzOiByZXN1bHRhZG8uYXRlbmRlbnRlLnN0YXR1cyxcbiAgICAgICAgdXN1YXJpbzoge1xuICAgICAgICAgIGlkOiByZXN1bHRhZG8udXN1YXJpby5pZCxcbiAgICAgICAgICBub21lOiByZXN1bHRhZG8udXN1YXJpby5ub21lLFxuICAgICAgICAgIGVtYWlsOiByZXN1bHRhZG8udXN1YXJpby5lbWFpbCxcbiAgICAgICAgICBhdGl2bzogcmVzdWx0YWRvLnVzdWFyaW8uYXRpdm8sXG4gICAgICAgIH0sXG4gICAgICAgIGRlc2F0aXZhZG9FbTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBkZXNhdGl2YWRvUG9yOiB7XG4gICAgICAgICAgaWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICBub21lOiBzZXNzaW9uLnVzZXIubmFtZSxcbiAgICAgICAgfSxcbiAgICAgICAgbW90aXZvLFxuICAgICAgICB0aXBvRGVzYXRpdmFjYW8sXG4gICAgICAgIGRhdGFSZWF0aXZhY2FvOiBkYXRhUmVhdGl2YWNhbyB8fCBudWxsLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGRlc2F0aXZhciBhdGVuZGVudGU6JywgZXJyb3IpO1xuXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgWm9kRXJyb3IpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAge1xuICAgICAgICAgIGVycm86IE1FTlNBR0VOU19FUlJPX0FURU5ERU5URVMuREFET1NfSU5WQUxJRE9TLFxuICAgICAgICAgIGRldGFsaGVzOiBlcnJvci5lcnJvcnMsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm86IE1FTlNBR0VOU19FUlJPX0FURU5ERU5URVMuRVJST19JTlRFUk5PIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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